# -*- coding: utf-8 -*-

##PyAutoGUI?ÃÉ??W???[??
import pyautogui

##?v???Z?X?êßå‰Ç∑?ÈÇΩ?ﬂÇ?OS????ÃÉ??W???[??
import re
import os
import subprocess
import sys
import time
import array

##Win32??UI???∆ê???p???W???[??
import win32api
import win32gui
import win32con

##Mac??Linux?ÃèÍçá?ÕÅA???R?¬ÇÃë????
#import re
#import subprocess
#?óòóp???ƒà»â??ÃÇÊÇ§?…Ç????
#
#from subprocess import Popen, PIPE
#cmd = "xwininfo -name (?E?C???h?E??)"
#p = Popen(cmd.split(' '),stdout = PIPE, stderr = PIPE)
#ret = str(p.communicate())
#coord = re.search('X:\s+(\d+)[^Y]+Y:\s+(\d+)',ret)
#appwin_x,appwin_y = coord.groups()
#
##?A?v???E?C???h?E?Ãç???(appwin_x,appwin_y)?????‹Ç?

#?»â??A???C?????[?`??
if __name__ == "__main__":
    #???s?O?Ãë“ã@(?b)
    time.sleep(1)
    #?? ÉT?C?Y?ÃéÊìæ
    screen_x,screen_y = pyautogui.size()

    #?}?E?X??(1,1)?…à⁄ì????ƒÇ???
    pyautogui.moveTo(1, 1, duration=1)

    #win32gui??g???ƒÉE?C???h?E?^?C?g????T??
    #Window?ÃÉn???h???Êìæ('?N???X??','?^?C?g???ÃàÍïî')?≈å????N???X???ÌÇ©??»Ç???????None?…Ç???
    #?L???«Ç????('#32770',"???O??t???ƒï€ë?")????
    parent_handle = win32gui.FindWindow(None, "calculator")

    #?n???h??ID?????»Ç???????A?d???N??????
    if parent_handle == 0 :
        cmd = 'start C:\Windows\System32\calc.exe'
        subprocess.Popen(cmd, shell=True)
        time.sleep(3)
        parent_handle = win32gui.FindWindow(None, "calculator")

    if parent_handle == 0 :
        print(u"sorry, application start error")
        sys.exit()

    #?n???h??????ÍÇΩ??A?E?C???h?E?Ãç???∆âE???Ãç??W?∆â? ÇÃÉA?N?e?B?u??
    #???»Ç›Ç…ÅA?A?v????ÃÉ{?^???∆Ç????Õë???Êí£??ŒÇ∆Ç?ÈÇØ?«ÅAwin32gui?≈Ç??∆ï??G?…Ç»ÇËÇ∑????
    #???∆Ç»Ç????A?A?v???Ãç??W?∆Ég?b?v???x???E?C???h?E?Ãè?ÒÇæÇ??g??
    if parent_handle > 0 :
        win_x1,win_y1,win_x2,win_y2 = win32gui.GetWindowRect(parent_handle)
        print(u"position:"+str(win_x1)+"/"+str(win_y1))
        apw_x = win_x2 - win_x1
        apw_y = win_y2 - win_y1
        print(u"view size:"+str(apw_x)+"/"+str(apw_y))
        win32gui.SetForegroundWindow(parent_handle)
        #?E?C???h?E?Ãä??S?»è??????ƒÇ???AFindWindow?≈ï?????v???????ËÇµ???Íçá?Ãï‚äÆ?p
        titlebar = win32gui.GetWindowText(parent_handle)
        classname = win32gui.GetClassName(parent_handle)


    #Drag/Drop?÷ê??????ÈÇØ??«ÅA????mouseDown??moveTo??g?????ŸÇ???????
    #?A?v???ÃÉ}?E?X?I?[?o?[??????D&D?≈ÇÕî??????»Ç?(?t?…î????????»Ç??ÊÇ§?…ég???Íçá??dragTo/dragRel??????)
    pyautogui.moveTo(win_x1+40,win_y1+4, duration=1)
    pyautogui.mouseDown(win_x1+40,win_y1+4, button='left')
    pyautogui.moveTo(100,200, duration=1)
    pyautogui.moveTo(110,100, duration=1)
    pyautogui.moveTo(120,300, duration=1)
    pyautogui.moveTo(130,100, duration=1)
    pyautogui.moveTo(140,300, duration=1)
    pyautogui.moveTo(150,100, duration=1)
    pyautogui.moveTo(160,300, duration=1)
    pyautogui.mouseUp(210,200, button='left')
    time.sleep(30)